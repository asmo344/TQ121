//===============================================================================================
// update history
//===============================================================================================

//---------------------------------------------------------------------------------------------
// 2022/10/03
//---------------------------------------------------------------------------------------------
// 1. 2D_HDR mode draft release
// 2. fix analog power setting for 2D mode (need to be clarified)
 
//===============================================================================================
// platform
//===============================================================================================
Version = 

[Sensor]
SensorName = T2001JA
SlaveID    = 0x10

[ParaList]
//===============================================================================================
// FORMAT: 1A1D=0x05; 1A2D=0x06; 2A1D=0x07; 2A2D=0x08; 0A2D=0x0A; 0A1D=0x0C
//===============================================================================================

//===============================================================================================
// I2C Switch Bus (TCA9543): operation setting
//===============================================================================================
FORMAT 0C // 0A1D

//----------------------------------------------------------------------------------------------
// channel 0 status @ [0]
//----------------------------------------------------------------------------------------------
//     | 0 => disable
// (v) | 1 => enable
//----------------------------------------------------------------------------------------------
// channel 1 status @ [1]
//----------------------------------------------------------------------------------------------
//     | 0 => disable
// (v) | 1 => enable
//----------------------------------------------------------------------------------------------
W 73 00 03
W 70 00 03

//===============================================================================================
// FX3: data bus setting
//===============================================================================================
FORMAT 05 // 1A1D

//----------------------------------------------------------------------------------------------
// gpif2_data_bug_wide @ 0x20
//----------------------------------------------------------------------------------------------
//     | 0 => reserved
//     | 1 => 8-bit wide (not supported yet)
//     | 2 => 16-bit wide
// (v) | 3 => 32-bit wide
//----------------------------------------------------------------------------------------------
W FF 20 03

//===============================================================================================
// FPGA: operation setting
//===============================================================================================
FORMAT 05 // 1A1D

//----------------------------------------------------------------------------------------------
// GPIO0, "MIC_EN" control @ 0x24[0]
//----------------------------------------------------------------------------------------------
// (v) | 0 => voltage level low
//     | 1 => voltage level high
//----------------------------------------------------------------------------------------------
W 60 24 6A

//===============================================================================================
// IOVDD Voltage Regulators (MIC24045-JFYFL): operation setting
//===============================================================================================
FORMAT 05 // 1A1D

//----------------------------------------------------------------------------------------------
// VOUT_REGISTER @ 0x03[7:0]
//----------------------------------------------------------------------------------------------
// (v) | 0xB4 => 1.80V
//     | 0xE0 => 2.82V
//     | 0xF0 => 3.30V
//----------------------------------------------------------------------------------------------
//W 52 03 B4
W 52 03 F0

//===============================================================================================
// FPGA: operation setting
//===============================================================================================
FORMAT 05 // 1A1D

//----------------------------------------------------------------------------------------------
// USB_PCLK_POL @ 0x10[7]
//----------------------------------------------------------------------------------------------
//     | 0 => non-reverse
// (v) | 1 => reverse
//----------------------------------------------------------------------------------------------
// MCLK_SEL @ 0x10[1:0]
//----------------------------------------------------------------------------------------------
// (v) | 00 => 24MHz
//     | 01 => 12MHz
//     | 10 => 6MHz
//     | 11 => disable
//----------------------------------------------------------------------------------------------
//W 60 10 80
W 60 10 C0

//----------------------------------------------------------------------------------------------
// GPIO6, "SR_EN" control @ 0x24[6]
//----------------------------------------------------------------------------------------------
//     | 0 => voltage level low
// (v) | 1 => voltage level high
//----------------------------------------------------------------------------------------------
// GPIO5, "MIPI_EN" control @ 0x24[5]
//----------------------------------------------------------------------------------------------
//     | 0 => voltage level low
// (v) | 1 => voltage level high
//----------------------------------------------------------------------------------------------
// GPIO4, "FPGA_Data_OUT" control @ 0x24[4]
//----------------------------------------------------------------------------------------------
// (v) | 0 => voltage level low
//     | 1 => voltage level high
//----------------------------------------------------------------------------------------------
// GPIO3, "TC_RST" control @ 0x24[3]
//----------------------------------------------------------------------------------------------
//     | 0 => voltage level low
// (v) | 1 => voltage level high
//----------------------------------------------------------------------------------------------
// PIN | DVP | MIPI
// ----|-----|-----
// OE1 | 1   | 0
// OE2 | 0   | 1
//----------------------------------------------------------------------------------------------
// GPIO2, "OE2" control @ 0x24[2]
//----------------------------------------------------------------------------------------------
// (v) | 0 => voltage level low
//     | 1 => voltage level high
//----------------------------------------------------------------------------------------------
// GPIO1, "OE1" control @ 0x24[1]
//----------------------------------------------------------------------------------------------
//     | 0 => voltage level low
// (v) | 1 => voltage level high
//----------------------------------------------------------------------------------------------
// GPIO0, "MIC_EN" control @ 0x24[0]
//----------------------------------------------------------------------------------------------
//     | 0 => voltage level low
// (v) | 1 => voltage level high
//----------------------------------------------------------------------------------------------
W 60 24 6B

//===============================================================================================
// FPGA: reset chip
//===============================================================================================
FORMAT 05 // 1A1D

//----------------------------------------------------------------------------------------------
// FPGA_RESET_CMOS @ 0x22[0]
//----------------------------------------------------------------------------------------------
//     | 0 => voltage level low
// (v) | 1 => voltage level high
//----------------------------------------------------------------------------------------------
// FPGA_STANDBY_CMOS @ 0x22[1]
//----------------------------------------------------------------------------------------------
//     | 0 => voltage level low
// (v) | 1 => voltage level high
//----------------------------------------------------------------------------------------------
W 60 22 02
S 5
W 60 22 03

// Disable TPG_EN to prevent loading FPGA test pattern before.
W 60 12 00

//===============================================================================================
// sensor: T2001JA
//===============================================================================================
FORMAT 05

//===============================================================================================
//
//===============================================================================================
RESET

//===============================================================================================
// sensor: analog setting
//===============================================================================================

// ** BANK 0 **
W 10 FD 00

//---------------------------------------------------------------------------------------------
// power control
//---------------------------------------------------------------------------------------------
W 10 DC FF

// comparator bias
W 10 D1 00
W 10 D2 00
W 10 D6 1F
W 10 D7 1F

//---------------------------------------------------------------------------------------------
// pixel driving enable
//---------------------------------------------------------------------------------------------
// dvs_en_rst_d,  dvs_en_grst_d => reg_if_1A @ B0:0xEA[7:0]
// dvs_en_gtx0_d, dvs_en_gtx1_d => reg_if_1B @ B0:0xEB[7:0]
// dvs_en_tx0_d,  dvs_en_tx1_d  => reg_if_1C @ B0:0xEC[7:0]
// dvs_en_sel_d                 => reg_if_1D @ B0:0xED[3:0]
W 10 EA 00
W 10 EB 00
W 10 EC 00
W 10 ED 00

//===============================================================================================
// sensor: operation config
//===============================================================================================

// ** BANK 0 **
W 10 FD 00

//----------------------------------------------------------------------------------------------
// sensor operation mode:
//----------------------------------------------------------------------------------------------
// reg_ssr_mode @ B0:0x11[2:0]
//----------------------------------------------------------------------------------------------
//     | 000 => 2D
// (v) | 010 => 2D_HDR
//     | 110 => 2D_HDR_DIFF 
//     | 001 => DV
//----------------------------------------------------------------------------------------------
// DV mode ROI control method: 
//----------------------------------------------------------------------------------------------
// reg_dv_roi_mode @ B0:0x11[3]
//----------------------------------------------------------------------------------------------
// (v) | 0 => by register (V: awin_vstr, awin_vsz)
//     | 1 => by GPIO     (V: window_sel[3:2])
//----------------------------------------------------------------------------------------------
// H1xV2 binning:
//----------------------------------------------------------------------------------------------
// reg_bin2_en @ B0:0x11[4]
//----------------------------------------------------------------------------------------------
// (v) | 0 => OFF
//     | 1 => ON
//----------------------------------------------------------------------------------------------
// H mirror: 
//----------------------------------------------------------------------------------------------
// reg_h_flip_en @ B0:0x11[5]
//----------------------------------------------------------------------------------------------
// (v) | 0 => OFF
//     | 1 => ON
//----------------------------------------------------------------------------------------------
// V flip:
//----------------------------------------------------------------------------------------------
// reg_v_flip_en @ B0:0x11[6]
//----------------------------------------------------------------------------------------------
// (v) | 0 => OFF
//     | 1 => ON
//----------------------------------------------------------------------------------------------
W 10 11 02

//----------------------------------------------------------------------------------------------
// video stream frame burst length:
//----------------------------------------------------------------------------------------------
// reg_drv_burst_len @ B0:0x13[7:0]
//----------------------------------------------------------------------------------------------
W 10 13 00

//----------------------------------------------------------------------------------------------
// pixel array ROI: dark area (32 from 0)
//----------------------------------------------------------------------------------------------
// reg_dwin_vstr @ B0:0x14[5:0]
// reg_dwin_vsz  @ B0:0x15[5:0]
//----------------------------------------------------------------------------------------------
W 10 14 00
W 10 15 20

//----------------------------------------------------------------------------------------------
// pixel array ROI: active area (800 from 0)
//----------------------------------------------------------------------------------------------
// reg_awin_vstr @ {B0:0x16[1:0],B0:0x17[7:0]}
// reg_awin_vsz  @ {B0:0x18[1:0],B0:0x19[7:0]} (NOTE: x20 apply in DV mode)
//----------------------------------------------------------------------------------------------
W 10 16 00
W 10 17 00
W 10 18 03
W 10 19 20

//===============================================================================================
// sensor: EV control
//===============================================================================================

// ** BANK 0 **
W 10 00 00

//-----------------------------------------------------------------------------------------------
// exposure time
//-----------------------------------------------------------------------------------------------
//     | DV     => reg_ev_expo_0
//     | 2D     => reg_ev_expo_0
// (v) | 2D_HDR => reg_ev_expo_0 ( long exposure) 
//     |           reg_ev_expo_1 (short exposure) < VBLK
//-----------------------------------------------------------------------------------------------

//-----------------------------------------------------------------------------------------------
// reg_ev_expo_0 @ {B0:0x22[7:0],B0:0x23[7:0]}
//----------------------------------------------------------------------------------------------- 
W 10 22 00
W 10 23 40

//----------------------------------------------------------------------------------------------- 
// reg_ev_expo_1 @ {B0:0x24[7:0],B0:0x25[7:0]}
//----------------------------------------------------------------------------------------------- 
W 10 24 00
W 10 25 15

//-----------------------------------------------------------------------------------------------
// gain index: 
//-----------------------------------------------------------------------------------------------
// reg_ev_gain @ B0:0x26[2:0]
//-----------------------------------------------------------------------------------------------
// 0 =>  0.5x
// 1 =>  1.0x
// 2 =>  2.0x
// 3 =>  4.0x
// 4 =>  8.0x
// 5 => 16.0x
// 6 => 32.0x
// 7 => 64.0x
//-----------------------------------------------------------------------------------------------
W 10 26 01

//===============================================================================================
// sensor: timing
//===============================================================================================

// ** BANK 0 **
W 10 00 00

//-----------------------------------------------------------------------------------------------
// VSCAN: 
//-----------------------------------------------------------------------------------------------
// reg_vscan_blk_len @ {B0:0x1A[7:0], B0:0x1B[7:0]} (in H)
//-----------------------------------------------------------------------------------------------
W 10 1A 00
W 10 1B 20

//-----------------------------------------------------------------------------------------------
// HSCAN:
//-----------------------------------------------------------------------------------------------
// reg_hscan_ph0_len @ {B0:0x1C[7:0],B0:0x1D[7:0]}
// reg_hscan_ph1_len @ {B0:0x1E[7:0],B0:0x1F[7:0]}
// reg_hscan_ph2_len @ {B0:0x20[7:0],B0:0x21[7:0]}
// reg_hscan_ph0_ext @ {B0:0x75[7:0],B0:0x76[7:0]}
//-----------------------------------------------------------------------------------------------
W 10 1C 01
W 10 1D 90
W 10 1E 05
W 10 1F 14
W 10 20 00
W 10 21 FA
W 10 75 00
W 10 76 C8

//-----------------------------------------------------------------------------------------------
// ADC @ tkclk(50MHz)
//-----------------------------------------------------------------------------------------------
// reg_dac_ofst_upd_ph1_t0 @ {B0:0x9C[7:0],B0:0x9D[7:0]}
// reg_dac_ofst_upd_ph1_t1 @ {B0:0x9E[7:0],B0:0x9F[7:0]}
//-----------------------------------------------------------------------------------------------
// reg_dac_freq_sel @ B0:0xA4[2:0]
// reg_adc_freq_sel @ B0:0xA4[6:4]
//-----------------------------------------------------------------------------------------------
// reg_dac_ramp_str_ph1 @ {B0:0xA0[7:0],B0:0xA1[7:0]}
// reg_dac_ramp_len_ph1 @ B0:0xA2[7:0]
// reg_dac_ramp_stp_ph1 @ B0:0xA3[7:0]
//-----------------------------------------------------------------------------------------------
// reg_adc_bcnt_str_ph1 @ {B0:0x71[7:0],B0:0x72[7:0]}
// reg_adc_bcnt_len_ph1 @ {B0:0x73[1:0],B0:0x74[7:0]}
//-----------------------------------------------------------------------------------------------
W 10 9C 00
W 10 9D 05
W 10 9E 04
W 10 9F FC
W 10 A4 03
W 10 A0 00
W 10 A1 DF
W 10 A2 82
W 10 A3 01
W 10 71 00
W 10 72 DF
W 10 73 03
W 10 74 FF

//-----------------------------------------------------------------------------------------------
// pixel circuit control
//-----------------------------------------------------------------------------------------------
// reg_grst_rst_ph0_t0 @ {B0:0x30[7:0],B0:0x31[7:0]}
//-----------------------------------------------------------------------------------------------
// reg_gtx_ph0_t0 @ {B0:0x32[7:0],B0:0x33[7:0]}
// reg_gtx_ph0_t1 @ {B0:0x34[7:0],B0:0x35[7:0]}
// reg_gtx_ph0_pol @ B0:0x57[3]
//-----------------------------------------------------------------------------------------------
// reg_gtx_ph2_t0 @ {B0:0x36[7:0],B0:0x37[7:0]}
// reg_gtx_ph2_t1 @ {B0:0x38[7:0],B0:0x39[7:0]}
// reg_gtx_ph2_pol @ B0:0x57[4]
//-----------------------------------------------------------------------------------------------
// reg_gfd_rst_ph0_t0 @ {B0:0x3A[7:0],B0:0x3B[7:0]}
//-----------------------------------------------------------------------------------------------
// reg_gfd_rst_ph2_t0 @ {B0:0x3C[7:0],B0:0x3D[7:0]}
// reg_gfd_rst_ph2_t1 @ {B0:0x3E[7:0],B0:0x3F[7:0]}
// reg_gfd_rst_ph2_pol @ B0:0x57[5]
//-----------------------------------------------------------------------------------------------
// reg_gtx_rst_ph0_t0 @ {B0:0x40[7:0],B0:0x41[7:0]}
// reg_gtx_rst_ph0_t1 @ {B0:0x42[7:0],B0:0x43[7:0]}
//-----------------------------------------------------------------------------------------------
// reg_gtx_rst_ph2_t0 @ {B0:0x44[7:0],B0:0x45[7:0]}
// reg_gtx_rst_ph2_t1 @ {B0:0x46[7:0],B0:0x47[7:0]}
//-----------------------------------------------------------------------------------------------
W 10 30 00
W 10 31 96
W 10 57 00
W 10 32 00
W 10 33 08
W 10 34 00
W 10 35 7A
W 10 36 00
W 10 37 8C
W 10 38 00
W 10 39 F0
W 10 3A 00
W 10 3B 82
W 10 3C 00
W 10 3D 14
W 10 3E 00
W 10 3F 78
W 10 40 00
W 10 41 32
W 10 42 00
W 10 43 5A
W 10 44 00
W 10 45 20
W 10 46 00
W 10 47 6B

//-----------------------------------------------------------------------------------------------
// column circuit control
//-----------------------------------------------------------------------------------------------
// reg_fd_rst_ph0_t0 @ {B0:0x77[7:0],B0:0x78[7:0]}
// reg_fd_rst_ph0_t1 @ {B0:0x79[7:0],B0:0x7A[7:0]}
// reg_fd_rst_ph0_t2 @ {B0:0x7B[7:0],B0:0x7C[7:0]}
// reg_fd_rst_ph0_t3 @ {B0:0x7D[7:0],B0:0x7E[7:0]}
// reg_fd_rst_ph0_pol @ B0:0xA7[0]
//-----------------------------------------------------------------------------------------------
// reg_vcm_sh_ph0_t0 @ {B0:0xAC[7:0],B0:0xAD[7:0]}
// reg_vcm_sh_ph0_t1 @ {B0:0xAE[7:0],B0:0xAF[7:0]}
// reg_vcm_sh_ph0_pol @ B0:0xA7[1]
//-----------------------------------------------------------------------------------------------
// reg_vcm_gen_ph0_t0 @ {B0:0xB0[7:0],B0:0xB1[7:0]}
// reg_vcm_gen_ph0_t1 @ {B0:0xB2[7:0],B0:0xB3[7:0]}
// reg_vcm_gen_ph0_pol @ B0:0xA7[2]
//-----------------------------------------------------------------------------------------------
// reg_ramp_rst_ini_ph0_t0 @ {B0:0xB4[7:0],B0:0xB5[7:0]}
// reg_ramp_rst_ini_ph0_t1 @ {B0:0xB6[7:0],B0:0xB7[7:0]}
// reg_ramp_rst_ini_ph0_pol @ B0:0xA7[3]
//-----------------------------------------------------------------------------------------------
// reg_ramp_rst1_ph0_t0 @ {B0:0xB8[7:0],B0:0xB9[7:0]}
// reg_ramp_rst1_ph0_t1 @ {B0:0xBA[7:0],B0:0xBB[7:0]}
// reg_ramp_rst1_ph0_pol @ B0:0xA7[4]
//-----------------------------------------------------------------------------------------------
// reg_ramp_rst2_ph0_t0 @ {B0:0xBC[7:0],B0:0xBD[7:0]}
// reg_ramp_rst2_ph0_t0 @ {B0:0xBE[7:0],B0:0xBF[7:0]}
// reg_ramp_rst2_ph0_pol @ B0:0xA7[5]
//-----------------------------------------------------------------------------------------------
// reg_comp_rst2_ph0_t0 @ {B0:0xC0[7:0],B0:0xC1[7:0]}
// reg_comp_rst2_ph0_t1 @ {B0:0xC2[7:0],B0:0xC3[7:0]}
// reg_comp_rst2_ph0_pol @ B0:0xA7[6]
//-----------------------------------------------------------------------------------------------
// reg_comp_rst3_ph0_t0 @ {B0:0xC4[7:0],B0:0xC5[7:0]}
// reg_comp_rst3_ph0_t1 @ {B0:0xC6[7:0],B0:0xC7[7:0]}
// reg_comp_rst3_ph0_pol @ B0:0xA7[7]
//-----------------------------------------------------------------------------------------------
// reg_rdo_tx_en_ph0_t0 @ {B0:0x48[7:0],B0:0x49[7:0]}
// reg_rdo_tx_en_ph0_t1 @ {B0:0x4A[7:0],B0:0x4B[7:0]}
//-----------------------------------------------------------------------------------------------
// reg_rdo_tx_en_ph1_t0 @ {B0:0x4C[7:0],B0:0x4D[7:0]}
// reg_rdo_tx_en_ph1_t1 @ {B0:0x4E[7:0],B0:0x4F[7:0]}
//-----------------------------------------------------------------------------------------------
// reg_comp_out_en_ph1_t0 @ {B0:0xC8[7:0],B0:0xC9[7:0]}
// reg_comp_out_en_ph1_t1 @ {B0:0xCA[7:0],B0:0xCB[7:0]}
//-----------------------------------------------------------------------------------------------
// reg_dout_en_ph1_t0 @ {B0:0xCC[7:0],B0:0xCD[7:0]}
// reg_dout_en_ph1_t1 @ {B0:0xCE[7:0],B0:0xCF[7:0]}
//-----------------------------------------------------------------------------------------------
// reg_dsft_ph1_t0 @ {B0:0x50[7:0],B0:0x51[7:0]}
// reg_dsft_ph1_t1 @ {B0:0x52[7:0],B0:0x53[7:0]}
//-----------------------------------------------------------------------------------------------
// reg_dsft_sub_dly @ B0:0x56[7:0]
// reg_dsft_sub_len @ B0:0x54[7:0]
// reg_dsft_sub_gap @ B0:0x55[7:0]
//-----------------------------------------------------------------------------------------------
W 10 A7 DF
W 10 77 00
W 10 78 00
W 10 79 00
W 10 7A C8
W 10 7B 00
W 10 7C 00
W 10 7D 00
W 10 7E 00
W 10 AC 00
W 10 AD 00
W 10 AE 00
W 10 AF 28
W 10 B0 00
W 10 B1 00
W 10 B2 00
W 10 B3 2A
W 10 B4 00
W 10 B5 00
W 10 B6 00
W 10 B7 2E
W 10 B8 00
W 10 B9 00
W 10 BA 00
W 10 BB 45
W 10 BC 00
W 10 BD 32
W 10 BE 00
W 10 BF B1
W 10 C0 00
W 10 C1 00
W 10 C2 01
W 10 C3 64
W 10 C4 00
W 10 C5 00
W 10 C6 01
W 10 C7 7F
W 10 48 03
W 10 49 E8
W 10 4A 03
W 10 4B E8
W 10 4C 00
W 10 4D 0C
W 10 4E 00
W 10 4F A8
W 10 C8 00
W 10 C9 B5
W 10 CA 04
W 10 CB F2
W 10 CC 00
W 10 CD C4
W 10 CE 04
W 10 CF F4
W 10 50 00
W 10 51 04
W 10 52 00
W 10 53 08
W 10 56 01
W 10 54 01
W 10 55 01

//===============================================================================================
// sensor: ISP
//===============================================================================================

// ** BANK 1 **
W 10 FD 01

//-----------------------------------------------------------------------------------------------
// isp mode selection
//----------------------------------------------------------------------------------------------- 
//     | reg_isp_2d_tpg_en @BK1:0x60[0]
//     | reg_isp_2d_msk_en @BK1:0x60[1]
// (v) | reg_isp_2d_hdr_en @BK1:0x60[2]
// (v) | reg_isp_2d_en     @BK1:0x60[3]
//     | reg_isp_dvs_en    @BK1:0x60[4]
//----------------------------------------------------------------------------------------------- 
W 10 60 0C

//===============================================================================================
// sensor: MIPI/DVP
//===============================================================================================

//===============================================================================================
// sensor: operation control
//===============================================================================================

// ** BANK 0 **
//W 10 FD 00

// kick start (control by platform SW tool)
//W 10 10 01